# Shadow

Проект для построения процесса децентрализованного интеграционного тестирования приложений.

## Описание

Процесс позволяет использовать машины разработчиков для запуска интеграционных тестов в фоне после коммита. Результаты тестов автоматически отправляются через удаленного агента в различные системы уведомлений и мониторинга.

## Как это работает

1. **Интеграционные тесты** - Пишем тесты, где мокаем внешние сервисы внутри приложения, кроме сервисов необходимых для выполнения целевой проверки
2. **Автоматический запуск** - Интеграционные и юнит тесты запускаются в фоне на пре-пуш хуках
3. **Отправка результатов** - Результаты тестов отправляются агенту, который может:
   - Отправить уведомление в мессенджер
   - Отправить результаты в тестплатформу
   - Приложить результат к реквесту в системе контроля версий
   - Собирать статистику

## Особенности

- ✅ **Безопасность** - Агент необходим для того, чтобы локально не прокидывать различные токены к системам
- ✅ **Простота настройки** - Процесс не требует много ресурсов и сложной конфигурации
- ✅ **Ненавязчивость** - Процесс не мешает разработчику
- ✅ **Кроссплатформенность** - Поддерживается на любой ОС
- ✅ **Расширяемость** - Может быть расширен под любой язык программирования
- ✅ **Интеграции** - Поддерживает расширения под любые интеграции

## Требования

- Любая операционная система (Windows, macOS, Linux)
- Система контроля версий (Git)
- Среда выполнения python скрипта
- Docker в случае с интеграционными тестами

## Установка
1 - В корне репозитория
```bash
curl -sSf https://raw.githubusercontent.com/gently-whitesnow/shadow/master/setup/setup.sh
sh setup.sh
```
2 - Задаем конфигурацию в файле .shadow/configuration.json
```json
{
    "agent_address": "http://localhost:8080", // required адрес агента
    "scope": "example" // required название команды, группы команд/сервисов
    "test_projects_root_absolute_path": [
        "example/Example.IntegrationTests/Example.IntegrationTests.csproj",
        "example/Example.UnitTests/Example.UnitTests.csproj"
    ] // optional (default root) пути к проектам с тестами, которые хотим запускать на пре-пуш хуке
}
```
### Проверка установки
1 - в файле lefthook.yml раскомментируем строку pre-commit и комметируем pre-push, выполняем в консоли
```bash
lefthook run post-commit
```
2 - в логах убеждаемся что тесты запустились и отправлены агенту
```bash
.shadow/test-run-<cfg>.log
```






